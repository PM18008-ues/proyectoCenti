{"remainingRequest":"/home/melvin/Escritorio/vuejs/fpi2021_final/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/melvin/Escritorio/vuejs/fpi2021_final/src/components/Modal.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/home/melvin/Escritorio/vuejs/fpi2021_final/src/components/Modal.vue","mtime":1636771953092},{"path":"/home/melvin/Escritorio/vuejs/fpi2021_final/node_modules/css-loader/dist/cjs.js","mtime":1636046005249},{"path":"/home/melvin/Escritorio/vuejs/fpi2021_final/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1636046005709},{"path":"/home/melvin/Escritorio/vuejs/fpi2021_final/node_modules/postcss-loader/src/index.js","mtime":1636046005397},{"path":"/home/melvin/Escritorio/vuejs/fpi2021_final/node_modules/cache-loader/dist/cjs.js","mtime":1636046004909},{"path":"/home/melvin/Escritorio/vuejs/fpi2021_final/node_modules/vue-loader/lib/index.js","mtime":1636046005545}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi50ZW1wbGF0ZSB7CiAgYmFja2dyb3VuZC1jb2xvcjogYmxhY2s7Cn0K"},{"version":3,"sources":["Modal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmcA;AACA;AACA","file":"Modal.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-row>\n    <v-dialog\n      v-model=\"dialog\"\n      transition=\"dialog-bottom-transition\"\n      fullscreen\n      hide-overlay\n    >\n      <v-card>\n        <v-toolbar dark color=\"primary\">\n          <v-btn icon dark @click=\"cancelar()\">\n            <v-icon>mdi-close</v-icon>\n          </v-btn>\n          <v-toolbar-title>Nuevo Anuncio</v-toolbar-title>\n          <v-spacer></v-spacer>\n        </v-toolbar>\n        {{ asignarNid() }}\n        {{ mostrarMensaje() }}\n        <v-container class=\"pt-12\">\n          <v-row>\n            <!-- Form de nuevo producto -->\n\n            <v-col lg=\"6\">\n              <v-card>\n                <v-card-text>\n                  <v-row class=\"pb-2\"\n                    ><v-radio-group v-model=\"radioGroup\">\n                      <v-radio :label=\"`Nuevo`\" :value=\"1\"></v-radio>\n                      <v-radio :label=\"`Usado`\" :value=\"2\"></v-radio>\n                    </v-radio-group>\n                  </v-row>\n                  <v-row class=\"pb-8\">\n                    <v-text-field\n                      style=\"max-width: 200px\"\n                      :rules=\"rules\"\n                      hide-details=\"auto\"\n                      solo\n                      v-model=\"marca\"\n                      ><label slot=\"prepend\">Marca:</label>\n                    </v-text-field>\n                  </v-row>\n                  <v-row class=\"pb-1\">\n                    <v-text-field style=\"max-width: 200px\" solo v-model=\"modelo\"\n                      ><label slot=\"prepend\">Modelo:</label>\n                    </v-text-field>\n                  </v-row>\n                  <v-row class=\"pb-8\">\n                    <v-text-field\n                      style=\"max-width: 200px\"\n                      :rules=\"rules\"\n                      hide-details=\"auto\"\n                      label=\"0.0\"\n                      solo\n                      v-model=\"pantalla\"\n                      ><label slot=\"prepend\">Pantalla:</label\n                      ><label slot=\"append\">Pulgadas</label>\n                    </v-text-field>\n                  </v-row>\n                  <v-row class=\"pb-4\">\n                    <v-select\n                      :items=\"sistemas\"\n                      style=\"max-width: 200px\"\n                      solo\n                      v-model=\"sistema\"\n                      ><label slot=\"prepend\">Sistema:</label>\n                    </v-select>\n                  </v-row>\n                  <v-row class=\"pb-1\">\n                    <v-text-field\n                      style=\"max-width: 200px\"\n                      solo\n                      v-model=\"rom\"\n                      type=\"number\"\n                      ><label slot=\"prepend\">ROM:</label>\n                      <label slot=\"append\">GB</label>\n                    </v-text-field>\n                  </v-row>\n                  <v-row class=\"pb-1\">\n                    <v-text-field\n                      style=\"max-width: 200px\"\n                      solo\n                      v-model=\"ram\"\n                      type=\"number\"\n                    >\n                      <label slot=\"prepend\">RAM:</label\n                      ><label slot=\"append\">GB</label>\n                    </v-text-field>\n                  </v-row>\n                </v-card-text>\n              </v-card>\n            </v-col>\n\n            <!-- form datos extra -->\n\n            <v-col lg=\"6\">\n              <v-row>\n                <h3>Titulo breve del anuncio</h3>\n              </v-row>\n              <!-- input de titulo -->\n              <v-row class=\"pb-8\"\n                ><v-text-field\n                  style=\"max-width: 75%\"\n                  :rules=\"rules\"\n                  hide-details=\"auto\"\n                  solo\n                  v-model=\"titulo\"\n                ></v-text-field>\n              </v-row>\n              <!-- Input vendedor -->\n              <v-row class=\"pb-8\">\n                <v-text-field\n                  style=\"max-width: 50%\"\n                  :rules=\"rules\"\n                  hide-details=\"auto\"\n                  solo\n                  v-model=\"vendedor\"\n                  ><label slot=\"prepend\">Vendedor:</label>\n                </v-text-field>\n              </v-row>\n              <!-- input telefono -->\n              <v-row class=\"pb-8\">\n                <v-text-field\n                  style=\"max-width: 40%\"\n                  :rules=\"rules\"\n                  hide-details=\"auto\"\n                  label=\"0000-0000\"\n                  solo\n                  v-model=\"telefono\"\n                  ><label slot=\"prepend\">Telefono:</label>\n                </v-text-field>\n              </v-row>\n              <!-- textarea descripcion -->\n              <v-row>\n                <h4>Descripcion:</h4>\n              </v-row>\n              <v-row>\n                <v-textarea\n                  solo\n                  name=\"input-7-4\"\n                  label=\"Descripcion del producto\"\n                  value=\"\"\n                  style=\"max-width: 70%\"\n                  v-model=\"descripcion\"\n                ></v-textarea>\n              </v-row>\n              <!-- input Precio -->\n              <v-row>\n                <h4>Precio:</h4>\n              </v-row>\n              <v-row>\n                <v-text-field\n                  style=\"max-width: 25%\"\n                  :rules=\"rules\"\n                  hide-details=\"auto\"\n                  label=\"00.00\"\n                  solo\n                  v-model=\"precio\"\n                >\n                  <label slot=\"prepend\">$</label>\n                </v-text-field>\n              </v-row>\n            </v-col>\n          </v-row>\n          <v-row>\n            <!-- botones de agregar y cancelar -->\n            <v-col lg=\"3\">\n              <v-row class=\"pb-4\">\n                <v-btn @click=\"agregar\" color=\"primary\" class=\"white--text\"\n                  ><v-icon color=\"white\">mdi-plus-circle</v-icon>Agregar</v-btn\n                >\n              </v-row>\n              <v-row>\n                <v-btn @click=\"cancelar()\" color=\"primary\" class=\"white--text\"\n                  ><v-icon color=\"white\">mdi-close-circle</v-icon\n                  >Cancelar</v-btn\n                >\n              </v-row>\n            </v-col>\n          </v-row>\n          <v-row>\n            <v-col cols=\"12\" class=\"text-center\">\n              <span class=\"subtitle-1\">Agregar Imagenes</span>\n            </v-col>\n            <v-col cols=\"12\" md=\"6\">\n              <v-file-input\n                v-model=\"file\"\n                multiple\n                label=\"Agregar Imagen\"\n                accept=\"image/*\"\n              ></v-file-input>\n              <v-btn :disabled=\"file == null\" @click=\"upload()\">Subir</v-btn>\n              <v-carousel>\n                <v-carousel-item\n                  v-for=\"(imagen, i) in imagenesUrl\"\n                  :key=\"i\"\n                  :src=\"imagen\"\n                  reverse-transition=\"fade-transition\"\n                  transition=\"fade-transition\"\n                ></v-carousel-item>\n              </v-carousel>\n            </v-col>\n            <v-col cols=\"12\" md=\"6\" class=\"hidden-sm-and-down\">\n              <v-simple-table>\n                <template v-slot:default>\n                  <thead>\n                    <tr>\n                      <th class=\"text-left\">Nombre</th>\n                      <th class=\"text-left\">Tama√±o</th>\n                      <th class=\"text-left\">-</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr v-for=\"(item, key) in imagenes\" :key=\"key\">\n                      <td>{{ item }}</td>\n                      <td></td>\n                      <td>\n                        <v-btn @click=\"eliminarImagen(key)\">Borrar</v-btn>\n                      </td>\n                    </tr>\n                  </tbody>\n                </template>\n              </v-simple-table>\n            </v-col>\n          </v-row>\n        </v-container>\n      </v-card>\n    </v-dialog>\n  </v-row>\n</template>\n\n<script>\nimport { db, st } from \"../db\";\nexport default {\n  name: \"Modal\",\n  data() {\n    return {\n      // datos del objeto\n      titulo: \"\",\n      nuevo: true,\n      marca: \"\",\n      modelo: \"\",\n      pantalla: null,\n      sistema: \"Android\",\n      rom: 0,\n      ram: 0,\n      vendedor: \"\",\n      telefono: \"\",\n      descripcion: \"\",\n      precio: 0,\n      hoy: new Date().toLocaleDateString(),\n\n      dialog: false,\n      radioGroup: 1,\n\n      //   reglas del input\n      rules: [\n        (value) => !!value || \"Requerido.\",\n        (value) => (value && value.length >= 3) || \"Min 3 caracteres\",\n      ],\n\n      //   sistemas\n      sistemas: [\"Android\", \"Windows\", \"Ios\"],\n\n      // datos de imagenes\n      nid: 0,\n      file: null,\n      downloadURL: \"\",\n      fileName: \"\",\n      imagenes: [],\n      imagenesUrl: [],\n      y: null,\n\n      borrado: false,\n      // productos de la bd\n      productos: [],\n\n      // mostrar mensaje\n      snackbar: false,\n    };\n  },\n  methods: {\n    asignarNid() {\n      if (this.productos.length === 0) {\n        this.nid = 1;\n      } else {\n        this.nid = this.productos.length + 1;\n      }\n    },\n\n    cancelar() {\n      // formatear el modal\n      (this.titulo = \"\"),\n        (this.nuevo = true),\n        (this.marca = \"\"),\n        (this.modelo = \"\"),\n        (this.pantalla = null),\n        (this.sistema = \"Android\"),\n        (this.rom = 0),\n        (this.ram = 0),\n        (this.vendedor = \"\"),\n        (this.telefono = \"\"),\n        (this.descripcion = \"\"),\n        (this.precio = 0),\n        (this.hoy = new Date().toLocaleDateString()),\n        (this.radioGroup = 1),\n        (this.file = null),\n        (this.downloadURL = \"\"),\n        (this.fileName = \"\"),\n        (this.imagenes = []),\n        (this.imagenesUrl = []);\n      this.borrado = false;\n\n      // cerrar ventana\n      this.dialog = false;\n      this.snackbar = false;\n    },\n\n    agregar() {\n      let newPro = true;\n\n      if (this.radioGroup === 1) {\n        newPro = true;\n      } else {\n        newPro = false;\n      }\n      var newProduc = {\n        titulo: this.titulo,\n        marca: this.marca,\n        nuevo: newPro,\n        modelo: this.modelo,\n        pantalla: this.pantalla,\n        sistema: this.sistema,\n        rom: this.rom.valueOf(),\n        ram: this.ram.valueOf(),\n        vendedor: this.vendedor,\n        telefono: this.telefono,\n        descripcion: this.descripcion,\n        precio: parseFloat(this.precio),\n        fecha: this.hoy,\n        nid: this.nid,\n        imagenes: this.imagenesUrl,\n      };\n\n      db.collection(\"productos\").add(newProduc);\n      this.cancelar();\n      this.snackbar = true;\n    },\n\n    upload() {\n      let bandera = true;\n      this.fileName = this.file[0].name;\n      this.limpiarCarpeta();\n      let carpeta = \"IDanuncio/\" + this.nid + \"/\" + this.fileName;\n      var archivo = st.ref(carpeta);\n      archivo\n        .put(this.file[0])\n        .then(() => {\n          archivo.getDownloadURL().then((url) => {\n            this.downloadURL = url;\n            for (let nombre in this.imagenes) {\n              if (this.imagenes[nombre] == this.fileName) {\n                bandera = false;\n                let ultimo = Object.keys(this.imagenesUrl).length;\n                this.imagenesUrl.push(this.downloadURL);\n                this.imagenesUrl[nombre] = this.imagenesUrl[ultimo];\n                this.imagenesUrl.pop(this.downloadURL);\n              }\n            }\n            this.file = null;\n            this.fileName = \"\";\n\n            if (bandera == true) {\n              this.imagenesUrl.push(this.downloadURL);\n              this.listarImagenes();\n            } else {\n              this.listarImagenes();\n            }\n          });\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n    },\n    eliminarImagen(index) {\n      this.imagenesUrl.splice(index, 1);\n      st.ref(\"IDanuncio/\" + this.nid + \"/\" + this.imagenes.splice(index, 1))\n        .delete()\n        .then(() => {\n          this.downloadURL = \"\";\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n      this.file = null;\n      this.fileName = \"\";\n    },\n    listarImagenes() {\n      var this2 = this;\n      this2.imagenes = [];\n      st.ref()\n        .child(\"IDanuncio/\" + this2.nid + \"/\")\n        .listAll()\n        .then((res) => {\n          res.items.forEach(function (itemRef) {\n            /* console.log(itemRef.tamanio) */\n            this2.imagenes.push(itemRef.name);\n          });\n        })\n        .catch((error) => {\n          console.log(error);\n        });\n      this.imagenesUrl.sort();\n    },\n\n    limpiarCarpeta() {\n      // let images = [];\n      st.ref()\n        .child(\"IDanuncio/\" + this.nid + \"/\")\n        .listAll()\n        .then((res) => {\n          let x = res.items.length;\n\n          // carpeta nueva\n          if (this.borrado === false && x === 0) {\n            this.borrado = true;\n            // carpeta existente con imagenes\n          } else if (this.borrado === false && x > 0) {\n            for (let i = 0; i < x; i++) {\n              st.ref(\n                \"IDanuncio/\" + this.nid + \"/\" + res.items[i].name\n              ).delete();\n            }\n            this.borrado = true;\n            // misma carpeta con imagenes\n          }\n        });\n    },\n\n    // mando el valor de la cadena al Padre\n    mostrarMensaje() {\n      this.$emit(\"guardado\", this.snackbar);\n    },\n  },\n\n  firestore: {\n    productos: db.collection(\"productos\"),\n  },\n};\n</script>\n\n<style>\n.template {\n  background-color: black;\n}\n</style>\n\n"]}]}